{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-03-24T17:25:17.358176Z", "invocation_id": "844d9b0f-8848-44e7-b49a-c129c2eaed22", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-24T17:25:17.211649Z", "completed_at": "2025-03-24T17:25:17.217877Z"}, {"name": "execute", "started_at": "2025-03-24T17:25:17.218321Z", "completed_at": "2025-03-24T17:25:17.276447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06616473197937012, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.premier_league_dbt.stg_pl_2425", "compiled": true, "compiled_code": "\n\nWITH cleaned AS (\n    SELECT\n        matchday,\n        TRIM(home_team) AS home_team,\n        TRIM(away_team) AS away_team,\n        -- Split score into home and away goals\n        CAST(SPLIT_PART(score, '-', 1) AS INTEGER) AS home_goals,\n        CAST(SPLIT_PART(score, '-', 2) AS INTEGER) AS away_goals\n    FROM \"five00k\".\"public\".\"premier_league_2425_raw\"\n)\nSELECT\n    matchday,\n    home_team,\n    away_team,\n    home_goals,\n    away_goals,\n    -- Add a unique match ID\n    ROW_NUMBER() OVER (ORDER BY matchday, home_team, away_team) AS match_id\nFROM cleaned", "relation_name": "\"five00k\".\"public\".\"stg_pl_2425\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-24T17:25:17.282125Z", "completed_at": "2025-03-24T17:25:17.284564Z"}, {"name": "execute", "started_at": "2025-03-24T17:25:17.284862Z", "completed_at": "2025-03-24T17:25:17.320420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039296627044677734, "adapter_response": {"_message": "SELECT 380", "code": "SELECT", "rows_affected": 380}, "message": "SELECT 380", "failures": null, "unique_id": "model.premier_league_dbt.pl_2425_matches", "compiled": true, "compiled_code": "\n\nSELECT\n    match_id,\n    matchday,\n    home_team,\n    away_team,\n    home_goals,\n    away_goals,\n    CASE \n        WHEN home_goals > away_goals THEN 'Home Win'\n        WHEN home_goals < away_goals THEN 'Away Win'\n        ELSE 'Draw'\n    END AS match_result\nFROM \"five00k\".\"public\".\"stg_pl_2425\"", "relation_name": "\"five00k\".\"public\".\"pl_2425_matches\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-24T17:25:17.324279Z", "completed_at": "2025-03-24T17:25:17.326896Z"}, {"name": "execute", "started_at": "2025-03-24T17:25:17.327191Z", "completed_at": "2025-03-24T17:25:17.347452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024544954299926758, "adapter_response": {"_message": "SELECT 20", "code": "SELECT", "rows_affected": 20}, "message": "SELECT 20", "failures": null, "unique_id": "model.premier_league_dbt.pl_2425_standings", "compiled": true, "compiled_code": "\n\nWITH match_points AS (\n    SELECT\n        home_team AS team,\n        SUM(CASE \n            WHEN home_goals > away_goals THEN 3\n            WHEN home_goals = away_goals THEN 1\n            ELSE 0\n        END) AS points,\n        COUNT(*) AS matches_played,\n        SUM(CASE WHEN home_goals > away_goals THEN 1 ELSE 0 END) AS wins,\n        SUM(CASE WHEN home_goals = away_goals THEN 1 ELSE 0 END) AS draws,\n        SUM(CASE WHEN home_goals < away_goals THEN 1 ELSE 0 END) AS losses,\n        SUM(home_goals) AS goals_for,\n        SUM(away_goals) AS goals_against\n    FROM \"five00k\".\"public\".\"stg_pl_2425\"\n    GROUP BY home_team\n\n    UNION ALL\n\n    SELECT\n        away_team AS team,\n        SUM(CASE \n            WHEN away_goals > home_goals THEN 3\n            WHEN away_goals = home_goals THEN 1\n            ELSE 0\n        END) AS points,\n        COUNT(*) AS matches_played,\n        SUM(CASE WHEN away_goals > home_goals THEN 1 ELSE 0 END) AS wins,\n        SUM(CASE WHEN away_goals = home_goals THEN 1 ELSE 0 END) AS draws,\n        SUM(CASE WHEN away_goals < home_goals THEN 1 ELSE 0 END) AS losses,\n        SUM(away_goals) AS goals_for,\n        SUM(home_goals) AS goals_against\n    FROM \"five00k\".\"public\".\"stg_pl_2425\"\n    GROUP BY away_team\n),\nstandings AS (\n    SELECT\n        team,\n        SUM(points) AS points,\n        SUM(matches_played) AS matches_played,\n        SUM(wins) AS wins,\n        SUM(draws) AS draws,\n        SUM(losses) AS losses,\n        SUM(goals_for) AS goals_for,\n        SUM(goals_against) AS goals_against,\n        SUM(goals_for) - SUM(goals_against) AS goal_difference\n    FROM match_points\n    GROUP BY team\n)\nSELECT\n    team,\n    matches_played,\n    wins,\n    draws,\n    losses,\n    goals_for,\n    goals_against,\n    goal_difference,\n    points,\n    RANK() OVER (ORDER BY points DESC, goal_difference DESC, goals_for DESC) AS position\nFROM standings\nORDER BY position", "relation_name": "\"five00k\".\"public\".\"pl_2425_standings\"", "batch_results": null}], "elapsed_time": 0.27762317657470703, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "favor_state": false, "populate_cache": true, "state_modified_compare_more_unrendered_values": false, "state_modified_compare_vars": false, "macro_debugging": false, "printer_width": 80, "project_dir": "/opt/dbt/", "log_level": "info", "empty": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "log_format_file": "debug", "use_colors_file": true, "version_check": true, "show_resource_report": false, "partial_parse": true, "which": "run", "send_anonymous_usage_stats": true, "introspect": true, "skip_nodes_if_on_run_start_fails": false, "log_path": "/opt/dbt/logs", "print": true, "indirect_selection": "eager", "log_format": "default", "log_file_max_bytes": 10485760, "log_level_file": "debug", "static_parser": true, "cache_selected_only": false, "select": [], "profiles_dir": "/opt/dbt/", "quiet": false, "strict_mode": false, "require_nested_cumulative_type_params": false, "invocation_command": "dbt run", "vars": {}, "exclude": [], "use_colors": true, "defer": false, "write_json": true, "source_freshness_run_project_hooks": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_yaml_configuration_for_mf_time_spines": false}}